"use strict";(self["webpackChunkcustomers_crud"]=self["webpackChunkcustomers_crud"]||[]).push([[177],{9874:function(t,e,s){s.r(e),s.d(e,{default:function(){return N}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("CustomerList")],1)},a=[],n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"list"},[e("b-container",[e("div",{staticClass:"list__notification"},[e("b-alert",{attrs:{show:t.dismissCountDown,variant:"success"},on:{dismissed:function(e){t.dismissCountDown=0},"dismiss-count-down":t.countDownChanged}},[t.deleteNotification?e("p",[t._v(" Customer has been deleted successfully ")]):e("p",[t._v(" Customer's Data updated successfully with a new name: "),e("strong",[t._v(t._s(t.customerNewName))]),t._v(" and a job title: "),e("strong",[t._v(t._s(t.customerJob))])])])],1),t.customers.length?e("b-row",t._l(t.customers,(function(s){return e("b-col",{key:s.id,attrs:{sm:"12",lg:"4"}},[e("CustomerCard",{attrs:{customer:s},on:{update:t.updateCustomer,delete:t.deleteCustomer}})],1)})),1):t.loading?e("b-row",{staticClass:"d-flex justify-content-center align-items-center"},[e("h3",[t._v("Loading ...")])]):e("b-row",{staticClass:"d-flex justify-content-center align-items-center"},[e("h3",[t._v("No data to preview")])])],1),t.customers.length?e("b-pagination",{attrs:{pills:"","total-rows":t.rows,"per-page":t.perPage,"first-text":"First","prev-text":"Prev","next-text":"Next","last-text":"Last"},on:{input:t.onChangingPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)},i=[],r=s(9669),u=s.n(r),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"customer text-center"},[e("div",[e("b-card",{staticClass:"mb-4",attrs:{title:t.customer.name?t.customer.name:`${t.customer.first_name} ${t.customer.last_name}`,"sub-title":t.customer.job?`${t.customer.job}`:"Customer","img-src":t.customer.avatar,"img-alt":t.customer.first_name,"img-top":""}},[e("b-card-text",[t._v(" "+t._s(t.customer.email)+" ")]),e("div",[e("div",{staticClass:"holdBtns"},[e("b-button",{attrs:{variant:"success",id:t.customer.id},on:{click:function(e){return t.handleOpenUpdate(`update - ${t.customer.id}`)}}},[t._v("Update")]),e("b-button",{attrs:{variant:"danger",id:t.customer.id},on:{click:function(e){return t.handleOpenDelete(`delete - ${t.customer.id}`)}}},[t._v("Delete")])],1),e("b-modal",{attrs:{id:`update - ${t.customer.id}`,"hide-footer":"","no-close-on-backdrop":"","hide-header-close":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" Update "+t._s(t.customer.first_name)+"'s data ")]},proxy:!0}])},[e("div",{staticClass:"d-block text-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.updatedInfo.newName,expression:"updatedInfo.newName"}],staticClass:"form-control mb-3",attrs:{type:"text",placeholder:"New name"},domProps:{value:t.updatedInfo.newName},on:{input:function(e){e.target.composing||t.$set(t.updatedInfo,"newName",e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.updatedInfo.job,expression:"updatedInfo.job"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Job title"},domProps:{value:t.updatedInfo.job},on:{input:function(e){e.target.composing||t.$set(t.updatedInfo,"job",e.target.value)}}})]),e("div",{staticClass:"holdSubmitBtns"},[e("b-button",{attrs:{disabled:!t.updatedInfo.newName||!t.updatedInfo.job,variant:"success"},on:{click:function(e){return t.updateCustomer(t.updatedInfo,`update - ${t.customer.id}`)}}},[t._v("Update")]),e("b-button",{on:{click:function(e){return t.handleCloseUpdate(`update - ${t.customer.id}`)}}},[t._v("Cancel")])],1)]),e("b-modal",{attrs:{id:`delete - ${t.customer.id}`,"hide-footer":"","no-close-on-backdrop":"","hide-header-close":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" Delete "+t._s(t.customer.first_name)+" ")]},proxy:!0}])},[e("div",{staticClass:"d-block text-left"},[t._v(" Are you sure you want to delete "),e("strong",[t._v(t._s(t.customer.first_name))]),t._v("? ")]),e("div",{staticClass:"holdSubmitBtns"},[e("b-button",{attrs:{variant:"danger"},on:{click:function(e){return t.deleteCustomer(t.updatedInfo.customerID,`delete - ${t.customer.id}`)}}},[t._v("Delete")]),e("b-button",{on:{click:function(e){return t.handleCloseDelete(`delete - ${t.customer.id}`)}}},[t._v("Cancel")])],1)])],1)],1)],1)])},c=[],l={name:"CustomerCard",props:{customer:{type:Object,default:()=>{}}},data(){return{updatedInfo:{customerID:this.customer.id,newName:"",job:""}}},methods:{handleOpenUpdate(t){this.$bvModal.show(t)},handleCloseUpdate(t){this.$bvModal.hide(t)},handleOpenDelete(t){this.$bvModal.show(t)},handleCloseDelete(t){this.$bvModal.hide(t)},updateCustomer(t,e){this.$emit("update",t),this.handleCloseUpdate(e)},deleteCustomer(t,e){this.$emit("delete",t),this.handleCloseDelete(e)}}},m=l,p=s(1001),h=(0,p.Z)(m,d,c,!1,null,"56332bae",null),f=h.exports,b={name:"CustomerList",components:{CustomerCard:f},data(){return{customers:[],customerID:null,customerNewName:"",customerJob:"",dismissSecs:5,dismissCountDown:0,deleteNotification:!1,currentPage:1,rows:null,perPage:6,loading:!1}},mounted(){this.loading=!0,this.getCustomers(this.currentPage)},methods:{onChangingPage(){this.getCustomers(this.currentPage),console.log("page changed")},async getCustomers(t){this.loading=!0;const e=await u().get(`/api/users?page=${t}`);200===e.status?(this.loading=!1,this.customers=e.data.data,this.rows=e.data.total,this.perPage=e.data.per_page):(this.loading=!1,this.customers=[])},async updateCustomer(t){this.customerID=t.customerID,this.customerNewName=t.newName,this.customerJob=t.job;const e=await u().put(`/api/users/${this.customerID}`,{name:this.customerNewName,job:this.customerJob});if(200===e.status){this.deleteNotification=!1,this.showAlert();const s=e.data,o=this.customers.findIndex((e=>e.id===t.customerID));if(-1!==o){const t=this.customers[o];this.customers.splice(o,1,{...s,...t})}}},async deleteCustomer(t){const e=await u()["delete"](`api/users/${t}`);if(204===e.status){this.deleteNotification=!0,this.showAlert();const e=this.customers.findIndex((e=>e.id===t));-1!==e&&this.customers.splice(e,1)}},countDownChanged(t){this.dismissCountDown=t},showAlert(){this.dismissCountDown=this.dismissSecs}}},v=b,C=(0,p.Z)(v,n,i,!1,null,"1678d5fe",null),g=C.exports,_={name:"HomePage",components:{CustomerList:g}},w=_,x=(0,p.Z)(w,o,a,!1,null,null,null),N=x.exports}}]);
//# sourceMappingURL=home.c7559123.js.map